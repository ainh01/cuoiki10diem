version: '3.8'

services:
  backend:
    image: ui_main
    container_name: ui-main
    ports:
      - "3000:3000"
    environment:
      # Use key: value format to avoid quote parsing issues
      - VITE_API_BASE_URL=http://134.185.90.103:8080/
      - VITE_OTRUYEN_API_BASE_URL=http://134.185.90.103:80/
      - VITE_APP_ENV=development
    restart: unless-stopped
    healthcheck:
      # Use node inside container to check the route so no extra binaries are required
      test: ["CMD-SHELL", "node -e \"require('http').get('http://127.0.0.1:3000/health', res => {process.exit(res.statusCode===200 ? 0 : 1)})\""]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 5s
